# -------------------------------------------------------------------------- ###
# Soru 1a ----
# -------------------------------------------------------------------------- ###
https://github.com/HaticeKevser/HaticeFinal

# -------------------------------------------------------------------------- ###
# Soru 2a ----
# -------------------------------------------------------------------------- ###
library(dplyr)

titanic %>%
  group_by(sex) %>%
  summarize(mean_fare = mean(fare, na.rm = TRUE))


# -------------------------------------------------------------------------- ###
# Soru 2b ----
# -------------------------------------------------------------------------- ###
library(tidyverse)

titanic %>%
  drop_na(age) %>%
  ggplot(aes(x = sex, y = age, fill = sex)) +
  geom_boxplot() +
  labs(x = "Cinsiyet", y = "Yaş", fill = "Cinsiyet") +
  theme_minimal()


# -------------------------------------------------------------------------- ###
# Soru 2c ----
# -------------------------------------------------------------------------- ###
library(tidyverse)

titanic %>%
  drop_na(age) %>%
  ggplot(aes(x = age, y = stat(density))) +
  geom_histogram(binwidth = 5, fill = "pink", color = "white") +
  labs(x = "Age", y = "Density") +
  theme_minimal()


# -------------------------------------------------------------------------- ###
# Soru 3a ----
# -------------------------------------------------------------------------- ###
c(10, 13)

# -------------------------------------------------------------------------- ###
# Soru 3b ----
# -------------------------------------------------------------------------- ###
library(dplyr)

dat3 <- inner_join(dat1, dat2)


# -------------------------------------------------------------------------- ###
# Soru 3c ----
# -------------------------------------------------------------------------- ###
ggplot(dat, aes(x = x, y = y)) +
  geom_point(color = "black") +
  geom_hline(yintercept = 0, color = "blue") +
  labs(title = "Grafik") +
  xlab("X Değeri") +
  ylab("Y Değeri")


# -------------------------------------------------------------------------- ###
# Soru 3d ----
# -------------------------------------------------------------------------- ###
 2.0 4.0


# -------------------------------------------------------------------------- ###
# Soru 3e ----
# -------------------------------------------------------------------------- ###

X̄ <- mean(X1:X25)
µ <- 0
S <- sd(X1:X25)

Z <- 5 * (X̄ - µ) / S

p_value <- pnorm(1, mean = 0, sd = 1, lower.tail = TRUE)

p_value


# -------------------------------------------------------------------------- ###
# Soru 3f ----
# -------------------------------------------------------------------------- ###
simulate_dice_rolls <- function(num_rolls) {
  dice_rolls <- sample(1:6, size = num_rolls * 2, replace = TRUE)
  dice_rolls <- matrix(dice_rolls, ncol = 2, byrow = TRUE)
  colnames(dice_rolls) <- c("Zar 1", "Zar 2")
  return(as.data.frame(dice_rolls))}

simulated_rolls <- simulate_dice_rolls(10)
print(simulated_rolls)


# -------------------------------------------------------------------------- ###
# Soru 3g ----
# -------------------------------------------------------------------------- ###
mean()
t.test()
titanic$titanic$survived
cat()

# -------------------------------------------------------------------------- ###
# Soru 4a ----
# -------------------------------------------------------------------------- ###
library(tidyr)

dat2 <- dat %>%
  pivot_longer(cols = -country, names_to = "year", values_to = "gdp") %>%
  mutate(year = as.integer(year))


# -------------------------------------------------------------------------- ###
# Soru 5a ----
# -------------------------------------------------------------------------- ###
ggplot(dat, aes(x = price)) +
  geom_histogram(binwidth = 5, aes(fill = cut)) +
  facet_wrap(~cut, nrow = 1) +
  labs(title = "sekil3", x = "Price", y = "Count") +
  scale_fill_manual(values = c("fair" = "black", "good" = "black", "very good" = "black", "premium" = "black", "ideal" = "black"))
